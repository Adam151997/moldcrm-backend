# Generated by Django 4.2.7 on 2025-11-15 11:10

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('accounts', '0002_alter_account_managers'),
        ('crm', '0005_create_activity_note_tables'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('integrations', '0003_plugin_pluginsynclog_pluginevent'),
    ]

    operations = [
        migrations.CreateModel(
            name='CampaignABTest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('test_name', models.CharField(max_length=200)),
                ('status', models.CharField(choices=[('testing', 'Testing'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], default='testing', max_length=20)),
                ('test_element', models.CharField(help_text='subject, from_name, content, send_time', max_length=50)),
                ('variant_a_value', models.TextField(help_text='Value for variant A')),
                ('variant_b_value', models.TextField(help_text='Value for variant B')),
                ('variant_c_value', models.TextField(blank=True, help_text='Optional variant C')),
                ('variant_d_value', models.TextField(blank=True, help_text='Optional variant D')),
                ('variant_e_value', models.TextField(blank=True, help_text='Optional variant E')),
                ('test_percentage', models.IntegerField(default=20, help_text='Percentage of total for testing')),
                ('variant_a_percentage', models.IntegerField(default=50, help_text='Percentage within test group')),
                ('variant_b_percentage', models.IntegerField(default=50)),
                ('variant_c_percentage', models.IntegerField(default=0)),
                ('variant_d_percentage', models.IntegerField(default=0)),
                ('variant_e_percentage', models.IntegerField(default=0)),
                ('win_metric', models.CharField(default='open_rate', help_text='open_rate, click_rate, conversion', max_length=50)),
                ('auto_select_winner', models.BooleanField(default=True)),
                ('hours_to_test', models.IntegerField(default=24, help_text='Duration before selecting winner')),
                ('variant_a_sent', models.IntegerField(default=0)),
                ('variant_a_opens', models.IntegerField(default=0)),
                ('variant_a_clicks', models.IntegerField(default=0)),
                ('variant_a_conversions', models.IntegerField(default=0)),
                ('variant_b_sent', models.IntegerField(default=0)),
                ('variant_b_opens', models.IntegerField(default=0)),
                ('variant_b_clicks', models.IntegerField(default=0)),
                ('variant_b_conversions', models.IntegerField(default=0)),
                ('variant_c_sent', models.IntegerField(default=0)),
                ('variant_c_opens', models.IntegerField(default=0)),
                ('variant_c_clicks', models.IntegerField(default=0)),
                ('variant_d_sent', models.IntegerField(default=0)),
                ('variant_e_sent', models.IntegerField(default=0)),
                ('winning_variant', models.CharField(blank=True, help_text='A, B, C, D, or E', max_length=1)),
                ('is_statistically_significant', models.BooleanField(default=False)),
                ('confidence_level', models.FloatField(default=0.0, help_text='Statistical confidence (0-100)')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='CampaignGoal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('goal_type', models.CharField(choices=[('open_rate', 'Open Rate'), ('click_rate', 'Click Rate'), ('click_to_open_rate', 'Click-to-Open Rate'), ('conversion_rate', 'Conversion Rate'), ('revenue', 'Revenue'), ('engagement_score', 'Engagement Score')], max_length=50)),
                ('target_value', models.FloatField(help_text='Target value to achieve')),
                ('actual_value', models.FloatField(default=0.0, help_text='Current actual value')),
                ('is_achieved', models.BooleanField(default=False)),
                ('achieved_at', models.DateTimeField(blank=True, null=True)),
                ('progress_percentage', models.FloatField(default=0.0, help_text='Progress towards goal (0-100%)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['campaign', 'goal_type'],
            },
        ),
        migrations.CreateModel(
            name='DripCampaign',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('trigger_type', models.CharField(choices=[('lead_created', 'Lead Created'), ('contact_created', 'Contact Created'), ('deal_stage_changed', 'Deal Stage Changed'), ('tag_added', 'Tag Added'), ('form_submitted', 'Form Submitted'), ('date_based', 'Date-Based (Birthday, Anniversary)'), ('manual', 'Manual Enrollment'), ('webhook', 'Webhook Trigger')], max_length=50)),
                ('trigger_config', models.JSONField(default=dict, help_text='Trigger-specific configuration')),
                ('enrollment_conditions', models.JSONField(default=dict, help_text='Who can enter this drip')),
                ('allow_re_enrollment', models.BooleanField(default=False)),
                ('max_enrollments_per_contact', models.IntegerField(default=1)),
                ('exit_conditions', models.JSONField(default=list, help_text='Conditions to exit sequence')),
                ('respect_unsubscribes', models.BooleanField(default=True)),
                ('skip_weekends', models.BooleanField(default=False)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('active', 'Active'), ('paused', 'Paused'), ('completed', 'Completed')], default='draft', max_length=20)),
                ('is_active', models.BooleanField(default=False)),
                ('total_enrolled', models.IntegerField(default=0)),
                ('currently_enrolled', models.IntegerField(default=0)),
                ('completed_count', models.IntegerField(default=0)),
                ('exited_early_count', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='DripCampaignEnrollment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('active', 'Active'), ('completed', 'Completed'), ('exited', 'Exited Early'), ('paused', 'Paused')], default='active', max_length=20)),
                ('enrolled_at', models.DateTimeField(auto_now_add=True)),
                ('next_send_at', models.DateTimeField(help_text='When to send next email')),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('exited_at', models.DateTimeField(blank=True, null=True)),
                ('exit_reason', models.CharField(blank=True, max_length=200)),
                ('steps_completed', models.IntegerField(default=0)),
                ('total_opens', models.IntegerField(default=0)),
                ('total_clicks', models.IntegerField(default=0)),
            ],
            options={
                'ordering': ['-enrolled_at'],
            },
        ),
        migrations.CreateModel(
            name='DripCampaignStep',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('step_number', models.IntegerField(help_text='Order in sequence (1, 2, 3...)')),
                ('name', models.CharField(max_length=200)),
                ('delay_value', models.IntegerField(default=1)),
                ('delay_unit', models.CharField(choices=[('minutes', 'Minutes'), ('hours', 'Hours'), ('days', 'Days'), ('weeks', 'Weeks')], default='days', max_length=20)),
                ('subject_override', models.CharField(blank=True, help_text='Override template subject', max_length=200)),
                ('has_branch', models.BooleanField(default=False)),
                ('branch_conditions', models.JSONField(blank=True, default=dict, help_text='If-then branching logic')),
                ('sent_count', models.IntegerField(default=0)),
                ('open_count', models.IntegerField(default=0)),
                ('click_count', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['drip_campaign', 'step_number'],
            },
        ),
        migrations.CreateModel(
            name='EmailEngagement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('opens_count', models.IntegerField(default=0)),
                ('first_opened_at', models.DateTimeField(blank=True, null=True)),
                ('last_opened_at', models.DateTimeField(blank=True, null=True)),
                ('clicks_count', models.IntegerField(default=0)),
                ('first_clicked_at', models.DateTimeField(blank=True, null=True)),
                ('last_clicked_at', models.DateTimeField(blank=True, null=True)),
                ('device_type', models.CharField(blank=True, help_text='desktop, mobile, tablet', max_length=50)),
                ('email_client', models.CharField(blank=True, help_text='Gmail, Outlook, etc.', max_length=100)),
                ('operating_system', models.CharField(blank=True, max_length=100)),
                ('browser', models.CharField(blank=True, max_length=100)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('country', models.CharField(blank=True, max_length=100)),
                ('timezone', models.CharField(blank=True, max_length=50)),
                ('user_agent', models.TextField(blank=True)),
                ('engagement_score', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='LinkClick',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('url', models.URLField(max_length=1000)),
                ('link_text', models.CharField(blank=True, help_text='Anchor text', max_length=500)),
                ('link_position', models.IntegerField(default=0, help_text='Position in email (1st link, 2nd link, etc.)')),
                ('utm_source', models.CharField(blank=True, max_length=100)),
                ('utm_medium', models.CharField(blank=True, max_length=100)),
                ('utm_campaign', models.CharField(blank=True, max_length=200)),
                ('utm_content', models.CharField(blank=True, max_length=200)),
                ('utm_term', models.CharField(blank=True, max_length=200)),
                ('clicked_at', models.DateTimeField(auto_now_add=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('device_type', models.CharField(blank=True, max_length=50)),
                ('user_agent', models.TextField(blank=True)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('country', models.CharField(blank=True, max_length=100)),
            ],
            options={
                'ordering': ['-clicked_at'],
            },
        ),
        migrations.CreateModel(
            name='Segment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('segment_type', models.CharField(choices=[('static', 'Static List'), ('dynamic', 'Dynamic (Auto-Update)'), ('behavioral', 'Behavioral')], default='dynamic', max_length=20)),
                ('filter_conditions', models.JSONField(default=dict, help_text='Visual filter builder conditions')),
                ('estimated_size', models.IntegerField(default=0, help_text='Estimated recipient count')),
                ('actual_size', models.IntegerField(default=0, help_text='Actual recipient count (after calculation)')),
                ('last_calculated_at', models.DateTimeField(blank=True, null=True)),
                ('auto_update', models.BooleanField(default=True, help_text='Auto-recalculate before each campaign')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='UnsubscribePreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_unsubscribed', models.BooleanField(default=False)),
                ('unsubscribed_at', models.DateTimeField(blank=True, null=True)),
                ('unsubscribe_reason', models.CharField(blank=True, choices=[('too_frequent', 'Emails too frequent'), ('not_relevant', 'Content not relevant'), ('never_subscribed', 'Never subscribed'), ('privacy_concerns', 'Privacy concerns'), ('other', 'Other')], max_length=50)),
                ('unsubscribe_reason_text', models.TextField(blank=True)),
                ('frequency_preference', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('never', 'Never (Unsubscribed)')], default='weekly', max_length=20)),
                ('campaign_type_preferences', models.JSONField(default=dict, help_text='Preferences per campaign type')),
                ('resubscribe_token', models.CharField(blank=True, max_length=100, unique=True)),
                ('resubscribed_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='ab_test_config',
            field=models.JSONField(blank=True, default=dict, help_text='A/B test configuration'),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='ab_test_enabled',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='bounce_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='campaign_type',
            field=models.CharField(choices=[('one_time', 'One-Time Broadcast'), ('recurring', 'Recurring'), ('triggered', 'Triggered/Automated'), ('ab_test', 'A/B Test')], default='one_time', max_length=20),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='click_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='click_to_open_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='completed_sending_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='conversion_count',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='conversion_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='delivered_count',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='delivery_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='description',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='failed_count',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='goal_metric',
            field=models.CharField(blank=True, help_text='open_rate, click_rate, conversion, revenue', max_length=50),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='goal_value',
            field=models.FloatField(default=0.0, help_text='Target value for goal'),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='hard_bounces',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='open_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='revenue_generated',
            field=models.DecimalField(decimal_places=2, default=0.0, max_digits=12),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='send_duration_seconds',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='send_optimization',
            field=models.CharField(choices=[('immediate', 'Send Immediately'), ('optimal_time', 'Optimal Time (AI)'), ('time_zone_aware', 'Time Zone Aware'), ('scheduled', 'Scheduled Time')], default='immediate', max_length=20),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='soft_bounces',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='spam_complaints',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='started_sending_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='throttle_rate',
            field=models.IntegerField(default=0, help_text='Emails per hour (0 = no throttling)'),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='track_clicks',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='track_opens',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='unique_clicks',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='unique_opens',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='unsubscribe_rate',
            field=models.FloatField(default=0.0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='unsubscribed_count',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='utm_campaign',
            field=models.CharField(blank=True, max_length=200),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='utm_content',
            field=models.CharField(blank=True, max_length=200),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='utm_medium',
            field=models.CharField(blank=True, default='email', max_length=100),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='utm_source',
            field=models.CharField(blank=True, default='moldcrm', max_length=100),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='utm_term',
            field=models.CharField(blank=True, max_length=200),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='ai_optimization_score',
            field=models.IntegerField(default=0, help_text='AI-generated optimization score (0-100)'),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='avg_click_rate',
            field=models.FloatField(default=0.0, help_text='Average click rate across campaigns'),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='avg_open_rate',
            field=models.FloatField(default=0.0, help_text='Average open rate across campaigns'),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='category',
            field=models.CharField(choices=[('marketing', 'Marketing'), ('sales', 'Sales'), ('support', 'Support'), ('transactional', 'Transactional'), ('automated', 'Automated')], default='marketing', max_length=50),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='design_json',
            field=models.JSONField(blank=True, default=dict, help_text='Design structure for visual builder'),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='is_archived',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='preview_text',
            field=models.CharField(blank=True, help_text='Inbox preview text (preheader)', max_length=150),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='spam_score',
            field=models.FloatField(default=0.0, help_text='Spam probability score'),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='thumbnail',
            field=models.URLField(blank=True, help_text='Template preview image', max_length=500),
        ),
        migrations.AddField(
            model_name='emailtemplate',
            name='usage_count',
            field=models.IntegerField(default=0, help_text='Number of times template has been used'),
        ),
        migrations.AlterField(
            model_name='emailcampaign',
            name='recipient_filter',
            field=models.JSONField(default=dict, help_text='Legacy/simple filter (deprecated, use segment)'),
        ),
        migrations.AlterField(
            model_name='emailcampaign',
            name='status',
            field=models.CharField(choices=[('draft', 'Draft'), ('scheduled', 'Scheduled'), ('sending', 'Sending'), ('completed', 'Completed'), ('paused', 'Paused'), ('cancelled', 'Cancelled')], default='draft', max_length=20),
        ),
        migrations.AlterField(
            model_name='emailcampaign',
            name='template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='integrations.emailtemplate'),
        ),
        migrations.AlterField(
            model_name='emailtemplate',
            name='template_type',
            field=models.CharField(choices=[('welcome', 'Welcome Email'), ('follow_up', 'Follow-up'), ('proposal', 'Proposal'), ('thank_you', 'Thank You'), ('reminder', 'Reminder'), ('newsletter', 'Newsletter'), ('promotional', 'Promotional'), ('transactional', 'Transactional'), ('drip', 'Drip Sequence'), ('custom', 'Custom')], max_length=50),
        ),
        migrations.AddIndex(
            model_name='emailcampaign',
            index=models.Index(fields=['account', 'status'], name='integration_account_09f796_idx'),
        ),
        migrations.AddIndex(
            model_name='emailcampaign',
            index=models.Index(fields=['campaign_type', 'status'], name='integration_campaig_1584fe_idx'),
        ),
        migrations.AddIndex(
            model_name='emailcampaign',
            index=models.Index(fields=['scheduled_at'], name='integration_schedul_6a54be_idx'),
        ),
        migrations.AddIndex(
            model_name='emailtemplate',
            index=models.Index(fields=['account', 'category'], name='integration_account_784831_idx'),
        ),
        migrations.AddIndex(
            model_name='emailtemplate',
            index=models.Index(fields=['template_type', 'is_active'], name='integration_templat_24c355_idx'),
        ),
        migrations.AddField(
            model_name='unsubscribepreference',
            name='account',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='unsubscribe_preferences', to='accounts.account'),
        ),
        migrations.AddField(
            model_name='unsubscribepreference',
            name='contact',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='unsubscribe_preference', to='crm.contact'),
        ),
        migrations.AddField(
            model_name='unsubscribepreference',
            name='lead',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='unsubscribe_preference', to='crm.lead'),
        ),
        migrations.AddField(
            model_name='unsubscribepreference',
            name='unsubscribed_from_campaign',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='integrations.emailcampaign'),
        ),
        migrations.AddField(
            model_name='segment',
            name='account',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='segments', to='accounts.account'),
        ),
        migrations.AddField(
            model_name='segment',
            name='created_by',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='segment',
            name='static_contacts',
            field=models.ManyToManyField(blank=True, related_name='static_segments', to='crm.contact'),
        ),
        migrations.AddField(
            model_name='segment',
            name='static_leads',
            field=models.ManyToManyField(blank=True, related_name='static_segments', to='crm.lead'),
        ),
        migrations.AddField(
            model_name='linkclick',
            name='email',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='link_clicks', to='integrations.email'),
        ),
        migrations.AddField(
            model_name='linkclick',
            name='engagement',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='clicks', to='integrations.emailengagement'),
        ),
        migrations.AddField(
            model_name='emailengagement',
            name='contact',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='email_engagements', to='crm.contact'),
        ),
        migrations.AddField(
            model_name='emailengagement',
            name='email',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='engagement', to='integrations.email'),
        ),
        migrations.AddField(
            model_name='emailengagement',
            name='lead',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='email_engagements', to='crm.lead'),
        ),
        migrations.AddField(
            model_name='dripcampaignstep',
            name='drip_campaign',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='steps', to='integrations.dripcampaign'),
        ),
        migrations.AddField(
            model_name='dripcampaignstep',
            name='template',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='integrations.emailtemplate'),
        ),
        migrations.AddField(
            model_name='dripcampaignenrollment',
            name='contact',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='drip_enrollments', to='crm.contact'),
        ),
        migrations.AddField(
            model_name='dripcampaignenrollment',
            name='current_step',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='current_enrollments', to='integrations.dripcampaignstep'),
        ),
        migrations.AddField(
            model_name='dripcampaignenrollment',
            name='drip_campaign',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='enrollments', to='integrations.dripcampaign'),
        ),
        migrations.AddField(
            model_name='dripcampaignenrollment',
            name='lead',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='drip_enrollments', to='crm.lead'),
        ),
        migrations.AddField(
            model_name='dripcampaign',
            name='account',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='drip_campaigns', to='accounts.account'),
        ),
        migrations.AddField(
            model_name='dripcampaign',
            name='created_by',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='campaigngoal',
            name='campaign',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='goals', to='integrations.emailcampaign'),
        ),
        migrations.AddField(
            model_name='campaignabtest',
            name='campaign',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ab_tests', to='integrations.emailcampaign'),
        ),
        migrations.AddField(
            model_name='emailcampaign',
            name='segment',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='campaigns', to='integrations.segment'),
        ),
        migrations.AddIndex(
            model_name='unsubscribepreference',
            index=models.Index(fields=['is_unsubscribed'], name='integration_is_unsu_c013e2_idx'),
        ),
        migrations.AddIndex(
            model_name='segment',
            index=models.Index(fields=['account', 'segment_type'], name='integration_account_c0f70a_idx'),
        ),
        migrations.AddIndex(
            model_name='linkclick',
            index=models.Index(fields=['email', 'url'], name='integration_email_i_65100b_idx'),
        ),
        migrations.AddIndex(
            model_name='linkclick',
            index=models.Index(fields=['clicked_at'], name='integration_clicked_aaaec9_idx'),
        ),
        migrations.AddIndex(
            model_name='emailengagement',
            index=models.Index(fields=['contact', 'engagement_score'], name='integration_contact_06b42c_idx'),
        ),
        migrations.AddIndex(
            model_name='emailengagement',
            index=models.Index(fields=['device_type'], name='integration_device__a54eff_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='dripcampaignstep',
            unique_together={('drip_campaign', 'step_number')},
        ),
        migrations.AddIndex(
            model_name='dripcampaignenrollment',
            index=models.Index(fields=['status', 'next_send_at'], name='integration_status_fc3704_idx'),
        ),
        migrations.AddIndex(
            model_name='dripcampaignenrollment',
            index=models.Index(fields=['drip_campaign', 'status'], name='integration_drip_ca_cf62a5_idx'),
        ),
    ]
